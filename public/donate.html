<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base target="_self">
    <title>Donate - Augustine Udefa Foundation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="shortcut icon" href="img/imgg.png" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@preline/preline@2.0.0/dist/preline.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="script.js" defer></script>
   
   <link rel="stylesheet" href="main.css">
</head>
<body class="bg-white dark:bg-gray-900 transition-colors duration-300 font-sans">
    <!-- Navigation -->
   <header class="sticky top-0 z-50 bg-white/90 dark:bg-gray-900/90 backdrop-blur-md border-b border-gray-200 dark:border-gray-800">
  <nav class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Grid: 3 columns -> logo | centered links | right area -->
    <div class="grid grid-cols-3 items-center h-20">
      <!-- left: logo -->
      <div class="flex items-center">
        <a href="index.html" id="logo-link" class="flex items-center space-x-3 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" aria-label="Augustine Udefa Foundation home">
          <img src="img/logo.PNG" alt="Augustine Udefa Foundation logo" class="h-10 w-auto sm:h-12 md:h-14 object-contain rounded-md shadow-sm" />
        </a>
      </div>

      <!-- center: links (perfectly centered on md+) -->
      <div class="hidden md:flex justify-center">
        <div class="flex items-center space-x-8">
          <a href="index.html" class="nav-link text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white" id="home-link">Home</a>
          <a href="about.html" class="nav-link text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white" id="about-link">About</a>
          <a href="program.html" class="nav-link text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white" id="programs-link">Programs</a>
          <a href="event.html" class="nav-link text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white" id="events-link">Events</a>
          <a href="volunteer.html" class="nav-link text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white" id="trustees-link">Volunteer</a>
          <a href="donate.html" class="nav-link text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white" id="donate-link">Donate</a>
            <a href="news.html" class="nav-link text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"
                id="news-link">News</a>
           
        </div>
      </div>

      <!-- right: (desktop area; mobile button is absolutely positioned below) -->
      <div class="flex justify-end items-center">
        <!-- Example right-side area for desktop (e.g., CTA). Keep empty if not needed. -->
        <div class="hidden md:block">
          <!-- optional CTA or icon -->
        </div>

        <!-- Mobile toggle: absolutely positioned so it's always at the right on small screens -->
        <button
          id="mobile-menu-button"
          class="md:hidden absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400 p-2 rounded-md"
          aria-expanded="false"
          aria-controls="mobile-menu"
          aria-label="Toggle menu"
        >
          <i class="fas fa-bars text-xl" aria-hidden="true"></i>
        </button>
      </div>
    </div>
  </nav>

  <!-- Mobile menu -->
  <div class="hidden md:hidden bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800" id="mobile-menu">
    <div class="px-2 pt-2 pb-3 space-y-1">
      <a href="index.html" class="block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800" id="mobile-home-link">Home</a>
      <a href="about.html" class="block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800" id="mobile-about-link">About</a>
      <a href="program.html" class="block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800" id="mobile-programs-link">Programs</a>
      <a href="event.html" class="block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800" id="mobile-events-link">Events</a>
      <a href="volunteer.html" class="block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800" id="mobile-trustees-link">Volunteer</a>
      <a href="donate.html" class="block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800" id="mobile-donate-link">Donate</a>
     <a href="news.html"
                class="block px-3 py-2 rounded-md text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"
                id="mobile-news-link">News</a>
                </div>
  </div>

  <!-- Mobile toggle script -->

</header>

    <!-- Hero Section -->
    <section class="relative h-96 flex items-center justify-center bg-gray-900 overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-r from-gray-900 to-transparent z-10"></div>
        <img src="https://images.unsplash.com/photo-1521791055366-0d553872125f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1469&q=80" 
             alt="Students benefiting from donations" 
             class="absolute inset-0 w-full h-full object-cover">
        <div class="relative z-20 text-center px-4">
            <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">Support Our Cause</h1>
            <p class="text-xl text-gray-300 max-w-2xl mx-auto">Your donation helps empower African youth through education, health, and community development.</p>
        </div>
    </section>

    <!-- Donation Form -->
    <section class="py-20 bg-white dark:bg-gray-900">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="bg-gray-50 dark:bg-gray-800 rounded-xl shadow-md overflow-hidden">
                <div class="p-8 md:p-10">
                    <h2 class="text-2xl md:text-3xl font-bold text-gray-900 dark:text-white mb-2">Make a Donation</h2>
                    <p class="text-gray-600 dark:text-gray-300 mb-6">Your generous support helps us continue our mission to empower African youth.</p>
                    
                    <form id="donation-form" class="space-y-6">
                        <!-- Currency Selection & Donation Amount -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Select Currency *</label>
                            <select id="currency-select" name="currency-select" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg mb-2 dark:bg-gray-700 dark:text-white">
                                <option value="USD">US Dollar ($)</option>
                                <option value="NGN">Naira (₦)</option>
                            </select>
                            <div id="exchange-rate-info" class="text-sm text-gray-500 mb-3">Fetching exchange rate...</div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Select Donation Amount (<span id="currency-label">USD</span>) *</label>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                <button type="button" class="donation-option py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-lg text-center transition-all" data-base="25">
                                    <span class="font-medium text-gray-900 dark:text-white" id="preset-amount-1">$25</span>
                                </button>
                                <button type="button" class="donation-option py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-lg text-center transition-all" data-base="50">
                                    <span class="font-medium text-gray-900 dark:text-white" id="preset-amount-2">$50</span>
                                </button>
                                <button type="button" class="donation-option py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-lg text-center transition-all" data-base="100">
                                    <span class="font-medium text-gray-900 dark:text-white" id="preset-amount-3">$100</span>
                                </button>
                                <button type="button" class="donation-option py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-lg text-center transition-all" data-base="250">
                                    <span class="font-medium text-gray-900 dark:text-white" id="preset-amount-4">$250</span>
                                </button>
                            </div>
                            <div class="mt-3 relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 dark:text-gray-400" id="custom-currency-symbol">$</span>
                                </div>
                                <input type="number" id="custom-amount" name="custom-amount" min="1" step="1" 
                                       class="pl-7 w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg form-input focus:outline-none focus:ring-1 focus:ring-gold-500 dark:bg-gray-700 dark:text-white" 
                                       placeholder="Other amount">
                            </div>
                            <input type="hidden" id="donation-amount" name="donation-amount" value="">
                        </div>
                        
                        <!-- Payment Method -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Payment Method *</label>
                            <div class="grid grid-cols-2 gap-3">
                                <button type="button" class="payment-method py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-lg text-center transition-all selected" data-method="card">
                                    <i class="far fa-credit-card text-lg mr-2 text-gold-500"></i>
                                    <span class="font-medium text-gray-900 dark:text-white">Credit/Debit Card</span>
                                </button>
                                <button type="button" class="payment-method py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-lg text-center transition-all" data-method="bank">
                                    <i class="fas fa-university text-lg mr-2"></i>
                                    <span class="font-medium text-gray-900 dark:text-white">Bank Transfer</span>
                                </button>
                            </div>
                            <input type="hidden" id="payment-method" name="payment-method" value="card">
                        </div>
                        
                        <!-- Card Payment Form (shown by default) -->
                        <div id="card-payment-form">
                            <div class="space-y-4">
                                <div>
                                    <label for="card-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Name on Card *</label>
                                    <input type="text" id="card-name" name="card-name" required 
                                           class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg form-input focus:outline-none focus:ring-1 focus:ring-gold-500 dark:bg-gray-700 dark:text-white">
                                </div>
                                
                                <div>
                                    <label for="card-number" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Card Number *</label>
                                    <input type="text" id="card-number" name="card-number" required 
                                           class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg form-input focus:outline-none focus:ring-1 focus:ring-gold-500 dark:bg-gray-700 dark:text-white"
                                           placeholder="1234 5678 9012 3456">
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label for="card-expiry" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Expiry Date *</label>
                                        <input type="text" id="card-expiry" name="card-expiry" required 
                                               class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg form-input focus:outline-none focus:ring-1 focus:ring-gold-500 dark:bg-gray-700 dark:text-white"
                                               placeholder="MM/YY">
                                    </div>
                                    <div>
                                        <label for="card-cvc" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">CVC *</label>
                                        <input type="text" id="card-cvc" name="card-cvc" required 
                                               class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg form-input focus:outline-none focus:ring-1 focus:ring-gold-500 dark:bg-gray-700 dark:text-white"
                                               placeholder="123">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bank Transfer Info (hidden by default) -->
                        <div id="bank-transfer-info" class="hidden bg-gray-100 dark:bg-gray-700 p-4 rounded-lg">
                            <h4 class="font-medium text-gray-900 dark:text-white mb-2">Bank Transfer Details</h4>
                            <div class="space-y-2 text-sm text-gray-600 dark:text-gray-300">
                            <p><span class="font-medium">Account Name:</span> Augustine Udefa Foundation</p>
                                <p><span class="font-medium">Bank Name:</span> Union Bank of Nigeria</p>
                                <p><span class="font-medium">USD Account Number:</span> 0235683684</p>
                                <p><span class="font-medium">NGN Account Number:</span> 0235700707</p>
                                <p><span class="font-medium">SWIFT CODE:</span> UBNINGLA</p>
                              
                                <!-- <p><span class="font-medium">Bank Name:</span>CITIBANK New York</p> -->
                                <!-- <p><span class="font-medium">SWIFT CODE:</span> CITIUS33</p> -->
                                <!-- <p><span class="font-medium">SWIFT Code:</span> ZEIBNGLA</p>    -->
                                <p class="mt-3">Please include your name as reference when making the transfer.</p>
                            </div>
                        </div>
                        
                        <!-- Donor Information -->
                        <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
                            <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Donor Information</h3>
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label for="first-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">First Name *</label>
                                    <input type="text" id="first-name" name="first-name" required 
                                           class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg form-input focus:outline-none focus:ring-1 focus:ring-gold-500 dark:bg-gray-700 dark:text-white">
                                </div>
                                <div>
                                    <label for="last-name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Last Name *</label>
                                    <input type="text" id="last-name" name="last-name" required 
                                           class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg form-input focus:outline-none focus:ring-1 focus:ring-gold-500 dark:bg-gray-700 dark:text-white">
                                </div>
                            </div>
                            <div class="mt-4">
                                <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email Address *</label>
                                <input type="email" id="email" name="email" required 
                                       class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg form-input focus:outline-none focus:ring-1 focus:ring-gold-500 dark:bg-gray-700 dark:text-white">
                            </div>
                            <div class="mt-4">
                                <label for="phone" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Phone Number</label>
                                <input type="tel" id="phone" name="phone" 
                                       class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg form-input focus:outline-none focus:ring-1 focus:ring-gold-500 dark:bg-gray-700 dark:text-white">
                            </div>
                        </div>
                        
                        <!-- Donation Frequency -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Donation Frequency</label>
                            <div class="grid grid-cols-2 gap-3">
                                <button type="button" class="frequency-option py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-lg text-center transition-all selected" data-frequency="one-time">
                                    <span class="font-medium text-gray-900 dark:text-white">One-Time</span>
                                </button>
                                <button type="button" class="frequency-option py-3 px-4 border border-gray-300 dark:border-gray-600 rounded-lg text-center transition-all" data-frequency="monthly">
                                    <span class="font-medium text-gray-900 dark:text-white">Monthly</span>
                                </button>
                            </div>
                            <input type="hidden" id="donation-frequency" name="donation-frequency" value="one-time">
                        </div>
                        
                        <!-- Submit Button -->
                        <div class="pt-4">
                            <button type="submit" class="w-full px-6 py-3 bg-gold-500 text-white rounded-lg hover:bg-gold-600 transition-colors font-medium">
                                Donate Now
                            </button>
                            <!-- <p class="text-xs text-gray-500 dark:text-gray-400 mt-2 text-center">
                                Your donation is secure and tax-deductible. By donating, you agree to our <a href="#" class="text-gold-500 hover:underline">Terms of Service</a> and <a href="#" class="text-gold-500 hover:underline">Privacy Policy</a>.
                            </p> -->
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer (unchanged) -->
   <footer class="bg-gray-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-lg font-semibold mb-4">Augustine Udefa Foundation</h3>
                    <p class="text-gray-400">Empowering African youth through education since 2025.</p>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="about.html" class="text-gray-400 hover:text-white transition-colors">About Us</a></li>
                        <li><a href="program.html" class="text-gray-400 hover:text-white transition-colors">Programs</a></li>
                        <li><a href="news.html" class="text-gray-400 hover:text-white transition-colors">News & Stories</a></li>
                        <li><a href="donate.html" class="text-gray-400 hover:text-white transition-colors">Donate</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Contact</h3>
                    <ul class="space-y-2 text-gray-400">
                        <li class="flex items-center"><i class="fas fa-map-marker-alt mr-2"></i>Ikot Nkebre 2, Along Health Centre, 8 Miles, Calabar, Cross River State, Nigeria.</li>
                        <li class="flex items-center"><i class="fas fa-phone-alt mr-2"></i> +234 816 261 5039</li>
                        <!-- <li class="flex items-center"><i class="fas fa-envelope mr-2"></i> augustineudefafoundation@gmail.com</li> -->
                        <li class="flex items-center"><i class="fas fa-envelope mr-2"></i> contact@augustineudefafoundation.com</li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Follow Us</h3>
                    <div class="flex space-x-4">
                          <a href="https://www.facebook.com/share/1CYdGtH2dk/?mibextid=wwXIfr" class="text-gray-400 hover:text-white transition-colors text-xl"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://x.com/UdefaFoundation" class="text-gray-400 hover:text-white transition-colors text-xl"><img width="24" height="24" src="img/icons8-twitter-48.png" alt="twitterx--v2"/></a>
                        <a href="https://www.instagram.com/augustineudefafoundation?igsh=eWsybWllYXlyMDB6&utm_source=qr" class="text-gray-400 hover:text-white transition-colors text-xl"><i class="fab fa-instagram"></i></a>
                           <a href="https://www.linkedin.com/in/augustine-udefa-foundation-a308a038a?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=ios_app" class="text-gray-400 hover:text-white transition-colors text-xl"><i class="fab fa-linkedin-in"></i></a>
                         <a href="https://www.youtube.com/@AugustineUdefaFoundation" class="text-gray-400 hover:text-white transition-colors text-xl"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-12 pt-8 text-center text-gray-400">
                <p>&copy; 2025 Augustine Udefa Foundation. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Paystack Inline Script -->
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <script>
        // Mobile menu toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        
        if (mobileMenuButton && mobileMenu) {
            mobileMenuButton.addEventListener('click', function() {
                const isHidden = mobileMenu.classList.contains('hidden');
                if (isHidden) {
                    mobileMenu.classList.remove('hidden');
                    mobileMenuButton.innerHTML = '<i class="fas fa-times text-xl"></i>';
                } else {
                    mobileMenu.classList.add('hidden');
                    mobileMenuButton.innerHTML = '<i class="fas fa-bars text-xl"></i>';
                }
            });
        }

        // --- Currency conversion using exchangerate.host ---
        // We'll fetch live USD -> NGN rate and use it to update preset amounts and conversions.
        let usdToNgnRate = null; // will be set by API

        async function fetchExchangeRate() {
            const infoEl = document.getElementById('exchange-rate-info');
            try {
                const res = await fetch('https://api.exchangerate.host/latest?base=USD&symbols=NGN');
                const data = await res.json();
                if (data && data.rates && data.rates.NGN) {
                    usdToNgnRate = data.rates.NGN;
                    infoEl.textContent = `1 USD = ${usdToNgnRate.toLocaleString('en-US')} NGN (source: exchangerate.host)`;
                } else {
                    infoEl.textContent = 'Exchange rate unavailable — using fallback.';
                    usdToNgnRate = 1500; // fallback
                }
            } catch (err) {
                console.error('Failed to fetch exchange rate', err);
                infoEl.textContent = 'Failed to fetch exchange rate — using fallback.';
                usdToNgnRate = 1500; // fallback
            }
            updatePresetAmounts();
        }

        // Donation amount selection logic
        const donationOptions = document.querySelectorAll('.donation-option');
        const customAmountInput = document.getElementById('custom-amount');
        const donationAmountInput = document.getElementById('donation-amount');
        const currencySelect = document.getElementById('currency-select');
        const currencyLabel = document.getElementById('currency-label');
        const customCurrencySymbol = document.getElementById('custom-currency-symbol');

        function updatePresetAmounts() {
            // baseUSD values are stored in data-base attribute
            donationOptions.forEach((btn, idx) => {
                const baseUSD = parseInt(btn.getAttribute('data-base'));
                const labelEl = btn.querySelector('span');
                if (currencySelect.value === 'USD') {
                    labelEl.textContent = `$${baseUSD}`;
                } else {
                    const ngn = Math.round(baseUSD * (usdToNgnRate || 1500));
                    labelEl.textContent = `₦${ngn.toLocaleString()}`;
                }
            });
            if (currencySelect.value === 'USD') {
                currencyLabel.textContent = 'USD';
                customCurrencySymbol.textContent = '$';
            } else {
                currencyLabel.textContent = 'NGN';
                customCurrencySymbol.textContent = '₦';
            }
        }

        // when a preset button is clicked, compute amount depending on selected currency
        donationOptions.forEach(option => {
            option.addEventListener('click', function() {
                donationOptions.forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                const baseUSD = parseInt(this.getAttribute('data-base'));
                let amount = baseUSD;
                if (currencySelect.value === 'NGN') {
                    amount = Math.round(baseUSD * (usdToNgnRate || 1500));
                }
                donationAmountInput.value = amount;
                customAmountInput.value = '';
            });
        });

        customAmountInput.addEventListener('input', function() {
            donationOptions.forEach(opt => opt.classList.remove('selected'));
            let val = parseFloat(this.value);
            if (!val || val <= 0) {
                donationAmountInput.value = '';
                return;
            }
            // the custom input is already in the currently selected currency
            donationAmountInput.value = Math.round(val);
        });

        // Payment method selection
        const paymentMethods = document.querySelectorAll('.payment-method');
        const paymentMethodInput = document.getElementById('payment-method');
        const cardPaymentForm = document.getElementById('card-payment-form');
        const bankTransferInfo = document.getElementById('bank-transfer-info');
        
        paymentMethods.forEach(method => {
            method.addEventListener('click', function() {
                paymentMethods.forEach(m => m.classList.remove('selected'));
                this.classList.add('selected');
                const methodType = this.getAttribute('data-method');
                paymentMethodInput.value = methodType;
                if (methodType === 'card') {
                    cardPaymentForm.classList.remove('hidden');
                    bankTransferInfo.classList.add('hidden');
                } else {
                    cardPaymentForm.classList.add('hidden');
                    bankTransferInfo.classList.remove('hidden');
                }
            });
        });

        // Frequency selection
        const frequencyOptions = document.querySelectorAll('.frequency-option');
        const donationFrequencyInput = document.getElementById('donation-frequency');
        frequencyOptions.forEach(option => {
            option.addEventListener('click', function() {
                frequencyOptions.forEach(opt => opt.classList.remove('selected'));
                this.classList.add('selected');
                donationFrequencyInput.value = this.getAttribute('data-frequency');
            });
        });

        // currency change
        currencySelect.addEventListener('change', function() {
            updatePresetAmounts();
            // clear selections to avoid mismatch
            donationOptions.forEach(opt => opt.classList.remove('selected'));
            donationAmountInput.value = '';
            customAmountInput.value = '';
        });

        // initialize: fetch exchange rate then update UI
        fetchExchangeRate();

      
/* ====== PAYSTACK CLIENT INTEGRATION (drop-in) ======
   Replace PAYSTACK_PUBLIC_KEY with your live public key (pk_live_xxx).
   This code opens the Paystack inline modal and then calls your server to verify the payment.
====================================================*/
const PAYSTACK_PUBLIC_KEY = 'pk_live_8fa5f1e498bc04f8c8ac4165f0904406d7dd215d'; 
// front-end API host resolution (dev vs production)
const isLocalHost = location.hostname === 'localhost' || location.hostname === '127.0.0.1' || location.protocol === 'file:';
const API_HOST = isLocalHost ? 'http://localhost:3000' : '';
const VERIFY_ENDPOINT = API_HOST ? `${API_HOST}/verify-payment` : '/api/verify-payment';


document.getElementById('donation-form').addEventListener('submit', async function(e) {
  e.preventDefault();

  // minimal client-side validation (keeps existing UX)
  if (!document.getElementById('donation-amount').value) {
    alert('Please select or enter a donation amount');
    return;
  }
  const email = document.getElementById('email').value.trim();
  const firstName = document.getElementById('first-name').value.trim();
  const lastName = document.getElementById('last-name').value.trim();
  if (!email || !firstName || !lastName) {
    alert('Please fill in all required donor information');
    return;
  }

  const currency = document.getElementById('currency-select').value; // 'NGN' or 'USD'
  const amountNum = parseFloat(document.getElementById('donation-amount').value);
  if (!amountNum || amountNum <= 0) {
    alert('Invalid donation amount');
    return;
  }

  // Paystack expects the amount in the smallest currency unit:
  // - NGN: kobo (multiply by 100)
  // - USD: cents (multiply by 100)
  const paystackAmount = Math.round(amountNum * 100);

  // show loading UI while setting up (optional)
  document.querySelector('button[type="submit"]').setAttribute('disabled', 'disabled');

  // Prepare metadata we want back from Paystack (optional)
  const metadata = {
    first_name: firstName,
    last_name: lastName,
    // you can add more custom metadata here if desired
  };

  // Setup Paystack inline
  const handler = PaystackPop.setup({
    key: PAYSTACK_PUBLIC_KEY,
    email: email,
    amount: paystackAmount,
    currency: currency,
    firstname: firstName,
    lastname: lastName,
    metadata: {
      custom_fields: [
        { display_name: "Donor Name", variable_name: "donor_name", value: `${firstName} ${lastName}` },
        { display_name: "Donation Frequency", variable_name: "frequency", value: document.getElementById('donation-frequency').value || 'one-time' }
      ]
    },
 callback: function (response) {
  console.log("Payment complete! Reference:", response.reference);

  // use variables that are in scope: email, currency, paystackAmount
  // NOTE: paystackAmount is already in smallest unit (kobo/cents)
  verifyPaymentOnServer(response.reference, email, currency, paystackAmount)
    .then(result => {
      document.querySelector('button[type="submit"]').removeAttribute('disabled');

      if (result && (result.verified || result.success)) {
        // Payment verified on server
        alert('✅ Payment verified! Reference: ' + response.reference);

        // optional: show your success UI, reset form
        document.getElementById('donation-form').reset();
        // restore UI selections
        document.querySelectorAll('.donation-option')[0]?.classList.add('selected');
        document.querySelectorAll('.payment-method')[0]?.classList.add('selected');
        document.querySelectorAll('.frequency-option')[0]?.classList.add('selected');
        document.getElementById('card-payment-form').classList.remove('hidden');
        document.getElementById('bank-transfer-info').classList.add('hidden');

        // TODO: run any post-payment logic: save to DB (server), send receipt, analytics, etc.
      } else {
        // server said not verified
        alert('⚠️ Payment could not be verified. If your card was charged we will reconcile and contact you.');
       // console.warn('Server verification response:', result);
      }
    })
    .catch(err => {
      document.querySelector('button[type="submit"]').removeAttribute('disabled');
      console.error('Error verifying payment on server', err);
     // alert('❌ Error verifying payment. Please contact support.');
    });
},


    onClose: function() {
      document.querySelector('button[type="submit"]').removeAttribute('disabled');
      // user closed the payment modal
    }
  });

  handler.openIframe();
});

// helper: verify payment with server (POST verifies using Paystack secret key)
async function verifyPaymentOnServer(reference, email, currency, amountInSmallestUnit) {
  try {
    const res = await fetch(VERIFY_ENDPOINT, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ reference, email, currency, amount: amountInSmallestUnit })
    });
    if (!res.ok) {
      const text = await res.text();
      throw new Error('Server verification failed: ' + text);
    }
    const json = await res.json();
    // expected response: { verified: true, data: {...} }
    return json;
  } catch (err) {
    console.error('verifyPaymentOnServer error', err);
    throw err;
  }
}

   // small formatting helpers (card number, expiry) — unchanged
        document.getElementById('card-number').addEventListener('input', function(e) {
            let value = this.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
            let formatted = '';
            for (let i = 0; i < value.length; i++) {
                if (i > 0 && i % 4 === 0) formatted += ' ';
                formatted += value[i];
            }
            this.value = formatted.substring(0, 19);
        });

        document.getElementById('card-expiry').addEventListener('input', function(e) {
            let value = this.value.replace(/\D/g, '');
            if (value.length > 2) this.value = value.substring(0, 2) + '/' + value.substring(2, 4);
            else this.value = value;
        });

    </script>
</body>
</html>
